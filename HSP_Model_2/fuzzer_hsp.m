%-------------------------------------------------------------------------------
% Team FUMBLEBUZZ
% HSP Model
% Parameter code adapted from HSP Model HspInit code by Zhe Hu
% Fuzzing code & param adaption written by Josephine Lamp
%-------------------------------------------------------------------------------

global initx;
loadGui = "false";

%Load original signals to compare
load orig.mat
fcsOrig = orig(1).logsout{1}.Values;
emaxlvOrig = orig(1).logsout{2}.Values;
emaxrvOrig = orig(1).logsout{3}.Values;
psaOrig = orig(1).logsout{4}.Values;
pmaxlvOrig = orig(1).logsout{5}.Values;
repOrig = orig(1).logsout{6}.Values;
pmaxrvOrig = orig(1).logsout{7}.Values;
rspOrig = orig(1).logsout{8}.Values;
stopOrig = orig(1).logsout{9}.Values;
fesOrig = orig(1).logsout{10}.Values;
tOrig = orig(1).logsout{11}.Values;
fevOrig = orig(1).logsout{12}.Values;
vuevOrig = orig(1).logsout{13}.Values;
vusvOrig = orig(1).logsout{14}.Values;
phiOrig = orig(1).logsout{15}.Values;

scaleBugs = zeros(15,1);
contractilityBugs = 0;
resistanceBugs = 0;
vusvBugs = 0;
vuevBugs = 0;
u
%Define fuzzing params
nExperiments = 1;
%scale fuzzing
scaleFactor = 1;
errorThreshold = 5;
%model properties fuzzing
contractility = 0;%1=True
resistance = 0;%1=True
unstressed = 0;%1=True

%generate inputs for fuzzer
for i=1:nExperiments

    disp('Building HSP Data Interface...')

    HspSaveCmd = ['save hsp_data ',...
        'Csa Csp Cep Csv Cev Cpa Cpp Cpv Rsa Rsv Rev Rpa Rpp Rpv ',...
        'Vusa Vusp Vuep Vupa Vupp Vupv Lsa Lpa ',...
        'Cla Vula Rla P0lv KElv Vulv KRlv ',...
        'Cra Vura Rra P0rv KErv Vurv KRrv Vt Tsys0 ksys'];

    %DEFINE DATA PARAMS for fuzzing

    %Compliance
    Csa=0.28 * scaleFactor;
    Csp=2.05 * scaleFactor;
    Cep=1.67 * scaleFactor;
    Csv=61.11 * scaleFactor;
    Cev=50.0 * scaleFactor;
    Cpa=0.76 * scaleFactor;
    Cpp=5.80 * scaleFactor;
    Cpv=25.37 * scaleFactor;

    %Hydraulic Resistance (mmHg*s/ml)
    if(resistance == 1)
        r = randi([20, 21]);
        Rsa=0.06 * (r/10);
        %  Rsp=3.307;
        %  Rep=1.407;
        Rsv=0.038 * (r/10);
        Rev=0.016 * (r/10);
        Rpa=0.023 * (r/10);
        Rpp=0.0894 * (r/10);
        Rpv=0.0056 * (r/10); 
        
    else
        Rsa=0.06 * scaleFactor;
        %  Rsp=3.307;
        %  Rep=1.407;
        Rsv=0.038 * scaleFactor;
        Rev=0.016 * scaleFactor;
        Rpa=0.023 * scaleFactor;
        Rpp=0.0894 * scaleFactor;
        Rpv=0.0056 * scaleFactor;   
    end
    
    %Unstressed Volumn (ml)
    Vusa=0 * scaleFactor;
    Vusp=274.4 * scaleFactor;
    Vuep=336.6 * scaleFactor;
    %   Vusv=1121;
    %   Vuev=1375;
    Vupa=0 * scaleFactor;
    Vupp=123 * scaleFactor;
    Vupv=120 * scaleFactor;

    %Inertance (mmHg*ml*s^(-2))    
    Lsa=0.22e-3 * scaleFactor;
    Lpa=0.18e-3 * scaleFactor;

    %Left Heart
    Cla=19.23 * scaleFactor;
    Vula=25 * scaleFactor;
    Vulv=16.77 * scaleFactor;
    Rla=25e-3 * scaleFactor;
    KElv=0.014 * scaleFactor;
    %Emaxlv=2.95;
    KRlv=3.75e-4 * scaleFactor;
    P0lv=1.5 * scaleFactor;

    %Right Heart
    Cra=31.25 * scaleFactor;
    Vura=25 * scaleFactor;
    Vurv=40.8 * scaleFactor;
    Rra=2.5e-3 * scaleFactor;
    KErv=0.011 * scaleFactor;
    %   Emaxrv=1.75;
    KRrv=1.4e-3 * scaleFactor;
    P0rv=1.5 * scaleFactor;

    %Heart Beat
    Tsys0=0.5 * scaleFactor;
    ksys=0.075 * scaleFactor;

    %Total Amount of Blood
    Vt=5300 * scaleFactor;
    
    %Adapt Emaxrv and Emaxlv for Contractility Property
    r = randi([1, 33]);
    if contractility == 1
        %Default
        %Carotid sinus afferent pathway
        Pn=92;
        fmin=2.52;
        fmax=47.78;
        ka=11.758;
        touz=6.37;
        toup=2.076;

        %Sympathetic efferent pathway
        fes1=2.10;
        fes0=16.11;
        kes=0.0675;
        fesmin=2.66;

        %Vagal efferent pathway
        fev0=3.2;
        fev1=6.3;
        kev=7.06;
        fcs0=25;

        % Initialize Effector Parameters                                              
        %     Emaxlv Emaxrv Rsp  Rep  Vusv  Vuev      Ts   Tv 
        %       1     2     3     4     5     6       7     8 
        Gx = [0.475 0.282  0.695 0.53 -265.4 -132.5  -0.13 0.09]';
      toux = [  8     8     6     6    20     20       2   1.5 ]';
       Dx  = [  2     2     2     2    5      5        2   0.2 ]';

        % Initial conditions
        initx = [2.392 1.412  2.49  0.78 1435.4  1537    0.58   0]';
        
        %Fuzz emaxlv and emaxrv
        Emaxrv = 0.282 * (r/100);
        Emaxlv = 0.475 * (r/100);
        
        Gx(1,1) = Emaxlv;
        Gx(1,2) = Emaxrv;
        
        % Save Control Params Data
        save hsp_control Pn fmin fmax ka touz toup ...
        fes1 fes0 kes fesmin fev0 fev1 kev fcs0 ...
        Gx toux Dx initx
    end

    % Save Data Params
    save hsp_data Csa Csp Cep Csv Cev Cpa Cpp Cpv Rsa Rsv Rev Rpa Rpp Rpv ...
        Vusa Vusp Vuep Vupa Vupp Vupv Lsa Lpa ...
        Cla Vula Rla P0lv KElv Vulv KRlv ...
        Cra Vura Rra P0rv KErv Vurv KRrv Vt Tsys0 ksys    

    %Get output
    out = sim('Hsp','ReturnWorkspaceOutputs','on',...
        'SaveFormat','Dataset');
    fcs = out(1).logsout{1}.Values;
    emaxlv = out(1).logsout{2}.Values;
    emaxrv = out(1).logsout{3}.Values;
    psa = out(1).logsout{4}.Values;
    pmaxlv = out(1).logsout{5}.Values;
    rep = out(1).logsout{6}.Values;
    pmaxrv = out(1).logsout{7}.Values;
    rsp = out(1).logsout{8}.Values;
    stop = out(1).logsout{9}.Values;
    fes = out(1).logsout{10}.Values;
    t = out(1).logsout{11}.Values;
    fev = out(1).logsout{12}.Values;
    vuev = out(1).logsout{13}.Values;
    vusv = out(1).logsout{14}.Values;
    phi = out(1).logsout{15}.Values;
    
    %Detector
    %Analyze output and check for property violations aka BUGS
    %For Scale Factor
    for b=1:min(length(fcs.data), length(fcsOrig.data))
        if abs(fcs.data(b) - (fcsOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(1) = scaleBugs(1) + 1;
        end
    end
    
    for b=1:min(length(emaxlv.data), length(emaxlvOrig.data))
        if abs(emaxlv.data(b) - (emaxlvOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(2) = scaleBugs(2) + 1;
        end
    end
    
    for b=1:min(length(emaxrv.data), length(emaxrvOrig.data))
        if abs(emaxrv.data(b) - (emaxrvOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(3) = scaleBugs(3) + 1;
        end
    end
    
    for b=1:min(length(psa.data), length(psaOrig.data))
        if abs(psa.data(b) - (psaOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(4) = scaleBugs(4) + 1;
        end
    end
    
    for b=1:min(length(pmaxlv.data), length(pmaxlvOrig.data))
        if abs(pmaxlv.data(b) - (pmaxlvOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(5) = scaleBugs(5) + 1;
        end
    end
    
    for b=1:min(length(rep.data), length(repOrig.data))
        if abs(rep.data(b) - (repOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(6) = scaleBugs(6) + 1;
        end
    end
    
    for b=1:min(length(pmaxrv.data), length(pmaxrvOrig.data))
        if abs(pmaxrv.data(b) - (pmaxrvOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(7) = scaleBugs(7) + 1;
        end
    end
    
    for b=1:min(length(rsp.data), length(rspOrig.data))
        if abs(rsp.data(b) - (rspOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(8) = scaleBugs(8) + 1;
        end
    end
    
    for b=1:min(length(stop.data), length(stopOrig.data))
        if abs(stop.data(b) - (stopOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(9) = scaleBugs(9) + 1;
        end
    end
    
    for b=1:min(length(fes.data), length(fesOrig.data))
        if abs(fes.data(b) - (fesOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(10) = scaleBugs(10) + 1;
        end
    end
    
    for b=1:min(length(t.data), length(tOrig.data))
        if abs(t.data(b) - (tOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(11) = scaleBugs(11) + 1;
        end
    end
    
    for b=1:min(length(fev.data), length(fevOrig.data))
        if abs(fev.data(b) - (fevOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(12) = scaleBugs(12) + 1;
        end
    end
    
    for b=1:min(length(vuev.data), length(vuevOrig.data))
        if abs(vuev.data(b) - (vuevOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(13) = scaleBugs(13) + 1;
        end
    end
    
    for b=1:min(length(vusv.data), length(vusvOrig.data))
        if abs(vusv.data(b) - (vusvOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(14) = scaleBugs(14) + 1;
        end
    end
    
    for b=1:min(length(phi.data), length(phiOrig.data))
        if abs(phi.data(b) - (phiOrig.data(b) * scaleFactor)) > errorThreshold
            scaleBugs(15) = scaleBugs(15) + 1;
        end
    end
    
    %For Properties:
    %For Contractility
    if contractility == 1
        for b=1:min(length(fcs.data), length(fcsOrig.data))
            if abs(fcs.data(b) - fcsOrig.data(b)) <50 || abs(fcs.data(b) - fcsOrig.data(b)) > 200
                contractilityBugs = contractilityBugs + 1;
            end
        end
    end
    
    %For resistance
    if resistance == 1
        for b=1:min(length(fcs.data), length(fcsOrig.data))
            if fcsOrig.data(b) - fcs.data(b) > 201 || fcsOrig.data(b) - fcs.data(b) < 0
                %fcsOrig.data(b) - fcs.data(b)
                resistanceBugs = resistanceBugs + 1;
            end
        end
    end
    
    %For unstressed volume
    if unstressed == 1
        for b=2:length(vusv.data)
            if abs(vusv.data(b-1) - vusv.data(b)) > 15
                vusvBugs = vusvBugs + 1;
            end
        end
        
        for b=2:length(vuev.data)
            if abs(vuev.data(b-1) - vuev.data(b)) > 15
                vuevBugs = vuevBugs + 1;
            end
        end
    end
    
    % Save output
    name = strcat("output/out", num2str(i), ".mat");
    save(name, 'out');

end

%Print total Bugs
o1 = sprintf("Scale Bugs Fcs = %d", scaleBugs(1));
o2 = sprintf("Scale Bugs Emaxlv = %d", scaleBugs(2));
o3 = sprintf("Scale Bugs Emaxrv = %d", scaleBugs(3));
o4 = sprintf("Scale Bugs Psa = %d", scaleBugs(4));
o5 = sprintf("Scale Bugs Pmaxlv = %d", scaleBugs(5));
o6 = sprintf("Scale Bugs Rep = %d", scaleBugs(6));
o7 = sprintf("Scale Bugs Pmaxrv = %d", scaleBugs(7));
o8 = sprintf("Scale Bugs Rsp = %d", scaleBugs(8));
o9 = sprintf("Scale Bugs Stop = %d", scaleBugs(9));
o10 = sprintf("Scale Bugs Fes = %d", scaleBugs(10));
o11 = sprintf("Scale Bugs T = %d", scaleBugs(11));
o12 = sprintf("Scale Bugs Fev = %d", scaleBugs(12));
o13= sprintf("Scale Bugs Vuev = %d", scaleBugs(13));
o14 = sprintf("Scale Bugs Vusv = %d", scaleBugs(14));
o15 = sprintf("Scale Bugs Phi = %d", scaleBugs(15));
o16 = sprintf("Scale Bugs Total Bugs = %d", sum(scaleBugs));

disp("-----SCALE BUGS-----")
disp(o1)
disp(o2)
disp(o3)
disp(o4)
disp(o5)
disp(o6)
disp(o7)
disp(o8)
disp(o9)
disp(o10)
disp(o11)
disp(o12)
disp(o13)
disp(o14)
disp(o15)
disp(o16)

disp("-----PROPERTY BUGS-----")
c = sprintf("Contractility Bugs = %d", contractilityBugs);
disp(c)
rs = sprintf("ResistanceBugs = %d", resistanceBugs);
disp(rs)
unstressedVolBugs = vusvBugs + vuevBugs;
v1 = sprintf("Unstressed Volume Bugs vusv = %d", vusvBugs);
disp(v1)
v2 = sprintf("Unstressed Volume Bugs vuev = %d", vuevBugs);
disp(v2)
v = sprintf("Unstressed Volume Total Bugs = %d", unstressedVolBugs);
disp(v)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Load GUI
if loadGui == "true"

    load HspInit

     %Main Window
     h0 = figure('Units','points', ...
        'Color',[0.7529411764705882 0.7529411764705882 0.7529411764705882], ...
        'Colormap',mat0, ...
        'Name','HSP Data Center', ...
        'NumberTitle','off', ...
        'PaperPosition',[18 180 576.0000000000001 432.0000000000002], ...
        'PaperUnits','points', ...
        'Position',[0 0 496.5517241379312 342.6206896551725], ...
        'Tag','Hsp', ...
        'ToolBar','none', ...
        'UserData',HspSaveCmd);

     %Title Label
     h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'FontName','Geneva', ...
        'FontSize',24, ...
        'FontWeight','bold', ...
        'ListboxTop',0, ...
        'Position',[55.24137931034484 291.7241379310345 394.7586206896552 29.79310344827587], ...
        'String','HSP Data Center', ...
        'Style','text', ...
        'Tag','TitleBar');

     %Save Button
     h1 = uicontrol('Parent',h0, ...
        'Style'             , 'pushbutton'              , ...
        'String'            , 'Save'                    , ...
        'Units'             , 'points'                  , ...
        'Position',[422.0689655172415 63.31034482758622 45.31034482758621 19.86206896551725], ...
        'Callback'          , HspSaveCmd                , ...
        'Tag'               , 'SaveBtn'                 );    

     %Reset Button
     h1 = uicontrol('Parent',h0, ...
        'Style'             , 'pushbutton'                      , ...
        'String'            , 'Reset'                           , ...
        'Units'             , 'points'                          , ...
        'Position',[423.3103448275863 33.51724137931035 45.31034482758621 19.86206896551725], ...
        'Callback'          , 'delete(gcf); HspInit;'            , ...                                , ...
        'Tag'               , 'ResetBtn'                        );    

     %Compliance

     %Csa
     h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat3, ...
        'String','Csa', ...
        'Style','text', ...
        'Tag','Csa');
     h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 258.2758620689656 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Csa)'), ...
       'Callback','Csa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
       'Tag','Csa');

    %Csp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat8, ...
        'String','Csp', ...
        'Style','text', ...
       'Tag','Csp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 235.8620689655173 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Csp)'), ...
       'Callback', 'Csp=str2num(get(gcbo, ''String''));',...
        'Style','edit', ...
        'Tag','Csp');

    %Cep
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat9, ...
        'String','Cep', ...
       'Style','text', ...
       'Tag','Cep');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 213.448275862069 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Cep)'), ...
       'Callback','Cep=str2num(get(gcbo, ''String''));',...
        'Style','edit', ...
       'Tag','Cep');

    %Csv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat10, ...
        'String','Csv', ...
        'Style','text', ...
        'Tag','Csv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',mat4, ...
       'String',eval('num2str(Csv)'), ...
       'Callback','Csv=str2num(get(gcbo, ''String''));',...
        'Style','edit', ...
        'Tag','Csv');

    %Cev
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat11, ...
       'String','Cev', ...
        'Style','text', ...
       'Tag','Cev');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 168.6206896551725 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Cev)'), ...
       'Callback','Cev=str2num(get(gcbo, ''String''));',...
        'Style','edit', ...
       'Tag','Cev');

    %Cpa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat12, ...
        'String','Cpa', ...
        'Style','text', ...
        'Tag','Cpa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 146.2068965517242 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Cpa)'), ...
       'Callback','Cpa=str2num(get(gcbo, ''String''));',...
        'Style','edit', ...
       'Tag','Cpa');

    %Cpp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat13, ...
        'String','Cpp', ...
        'Style','text', ...
        'Tag','Cpp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 123.7931034482759 37.24137931034483 12.41379310344828], ...
        'String',eval('num2str(Cpp)'), ...
       'Style','edit', ...
       'Callback','Cpp=str2num(get(gcbo, ''String''));',...
       'Tag','Cpp');

    %Cpv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[47.79310344827587 101.3793103448276 37.24137931034483 12.41379310344828], ...
        'String',eval('num2str(Cpv)'), ...
       'Style','edit', ...
       'Callback','Cpv=str2num(get(gcbo, ''String''));',...
        'Tag','Cpv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat14, ...
        'String','Cpv', ...
        'Style','text', ...
        'Tag','Cpv');

    %Vusa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat22, ...
        'String','Vusa', ...
        'Style','text', ...
        'Tag','Vusa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[147.1034482758621 259.448275862069 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Vusa)'), ...
       'Callback','Vusa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vusa');

    %Vusp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat21, ...
        'String','Vusp', ...
        'Style','text', ...
        'Tag','Vusp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[147.1034482758621 237.1034482758621 37.24137931034483 12.41379310344828], ...
        'String',eval('num2str(Vusp)'), ...
       'Callback','Vusp=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vusp');

    %Vuep
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat20, ...
        'String','Vuep', ...
        'Style','text', ...
        'Tag','Vuep');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[147.1034482758621 214.7586206896552 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Vuep)'), ...
       'Callback','Vuep=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vuep');

    %Vusv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat19, ...
        'String','Vusv', ...
        'Style','text', ...
        'Tag','Vusv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[147.1034482758621 192.4137931034483 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(initx(5))'), ...
       'Callback','initx(5)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vusv');

    %Vuev
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat18, ...
        'String','Vuev', ...
        'Style','text', ...
        'Tag','Vuev');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[147.1034482758621 170.0689655172414 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(initx(6))'), ...
       'Callback','initx(6)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vuev');

    %Vupa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat17, ...
        'String','Vupa', ...
        'Style','text', ...
        'Tag','Vupa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[147.1034482758621 147.7241379310345 37.24137931034483 12.41379310344828], ...
         'String',eval('num2str(Vupa)'), ...
       'Callback','Vupa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
       'Tag','Vupa');

    %Vupp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat16, ...
        'String','Vupp', ...
        'Style','text', ...
        'Tag','Vupp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[147.1034482758621 124.7586206896552 37.24137931034483 12.41379310344828], ...
         'String',eval('num2str(Vupp)'), ...
       'Callback','Vupp=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vupp');

    %Vupv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat15, ...
        'String','Vupv', ...
        'Style','text', ...
        'Tag','Vupv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[147.1034482758621 102.4137931034483 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Vupv)'), ...
       'Callback','Vupv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vupv');

    %Rsa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 258.2068965517242 24.20689655172414 12.41379310344828], ...
        'String','Rsa', ...
        'Style','text', ...
       'Tag','Rsa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 258.8275862068966 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rsa)'), ...
       'Callback','Rsa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rsa');

    %Rsp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 235.8620689655173 24.20689655172414 12.41379310344828], ...
        'String','Rsp', ...
        'Style','text', ...
       'Tag','Rsp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 236.4827586206897 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(initx(3))'), ...
       'Callback','initx(3)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rsp');

    %Rep
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 213.5172413793104 24.20689655172414 12.41379310344828], ...
        'String','Rep', ...
        'Style','text', ...
        'Tag','Rep');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 214.1379310344828 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(initx(4))'), ...
       'Callback','initx(4)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rep');

    %Rsv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 191.1724137931035 24.20689655172414 12.41379310344828], ...
        'String','Rsv', ...
        'Style','text', ...
       'Tag','Rsv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 191.7931034482759 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rsv)'), ...
       'Callback','Rsv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rsv');

    %Rev
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 168.8275862068966 24.20689655172414 12.41379310344828], ...
        'String','Rev', ...
        'Style','text', ...
        'Tag','Rev');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 169.448275862069 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rev)'), ...
       'Callback','Rev=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rev');

    %Rpa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[209.7931034482759 146.4827586206897 24.20689655172414 12.41379310344828], ...
        'String','Rpa', ...
        'Style','text', ...
        'Tag','Rpa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 147.1034482758621 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rpa)'), ...
       'Callback','Rpa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rpa');

    %Rpp
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat23, ...
        'String','Rpp', ...
        'Style','text', ...
        'Tag','Rpp');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 124.1379310344828 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rpp)'), ...
       'Callback','Rpp=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
       'Tag','Rpp');

    %Rpv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat24, ...
        'String','Rpv', ...
        'Style','text', ...
        'Tag','Rpv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[243.9310344827587 101.7931034482759 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rpv)'), ...
       'Callback','Rsa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rpv');

    %Cla
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 258.8275862068966 24.20689655172414 12.41379310344828], ...
        'String','Cla', ...
        'Style','text', ...
       'Tag','Cla');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[342.0000000000001 259.448275862069 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Cla)'), ...
       'Callback','Cla=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Cla');


    %Vula
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 236.4827586206897 24.20689655172414 12.41379310344828], ...
        'String','Vula', ...
        'Style','text', ...
       'Tag','Vula');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[342.0000000000001 237.1034482758621 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Vula)'), ...
       'Callback','Vula=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vula');


    %Rla
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 214.1379310344828 24.20689655172414 12.41379310344828], ...
        'String','Rla', ...
        'Style','text', ...
       'Tag','Rla');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[342.0000000000001 214.7586206896552 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Rla)'), ...
       'Callback','Rla=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rla');

    %P0lv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 191.7931034482759 24.20689655172414 12.41379310344828], ...
        'String','P0lv', ...
        'Style','text', ...
       'Tag','P0lv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[342.0000000000001 192.4137931034483 37.24137931034483 12.41379310344828], ...
        'String',eval('num2str(P0lv)'), ...
       'Callback','P0lv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','P0lv');

    %KElv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 169.448275862069 24.20689655172414 12.41379310344828], ...
        'String','KElv', ...
        'Style','text', ...
       'Tag','KElv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[342.0000000000001 170.0689655172414 37.24137931034483 12.41379310344828], ...
        'String',eval('num2str(KElv)'), ...
       'Callback','KElv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','KElv');

    %Vulv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 147.1034482758621 24.20689655172414 12.41379310344828], ...
        'String','Vulv', ...
        'Style','text', ...
       'Tag','Vulv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[342.0000000000001 147.7241379310345 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Vulv)'), ...
       'Callback','Vulv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vulv');

    %Emaxlv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 124.1379310344828 24.20689655172414 12.41379310344828], ...
        'String','Emlv', ...
        'Style','text', ...
       'Tag','Emaxlv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[342.0000000000001 124.7586206896552 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(initx(1))'), ...
       'Callback','initx(1)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Emaxlv');

    %KRlv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[307.8620689655173 101.7931034482759 24.20689655172414 12.41379310344828], ...
        'String','KRlv', ...
        'Style','text', ...
       'Tag','KRlv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[342.0000000000001 102.4137931034483 37.24137931034483 12.41379310344828], ...
         'String',eval('num2str(KRlv)'), ...
       'Callback','KRlv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','KRlv');

    %Cra
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 260.0689655172415 24.20689655172414 12.41379310344828], ...
        'String','Cra', ...
        'Style','text', ...
        'Tag','Cra');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[433.8620689655173 260.6896551724138 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(Cra)'), ...
       'Callback','Cra=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Cra');

    %Vura
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 237.7241379310345 24.20689655172414 12.41379310344828], ...
        'String','Vura', ...
        'Style','text', ...
       'Tag','Vura');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',mat25, ...
       'String',eval('num2str(Vura)'), ...
       'Callback','Vura=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vura');

    %Rra
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',mat30, ...
        'String','Rra', ...
        'Style','text', ...
       'Tag','Rra');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',mat26, ...
         'String',eval('num2str(Rra)'), ...
       'Callback','Rra=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Rra');

    %P0rv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 193.0344827586207 24.20689655172414 12.41379310344828], ...
        'String','P0rv', ...
        'Style','text', ...
       'Tag','P0rv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',[433.8620689655173 193.6551724137931 37.24137931034483 12.41379310344828], ...
       'String',eval('num2str(P0rv)'), ...
       'Callback','P0rv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','P0rv');

    %KErv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 170.6896551724138 24.20689655172414 12.41379310344828], ...
        'String','KErv', ...
        'Style','text', ...
        'Tag','KErv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',mat27, ...
       'String',eval('num2str(KErv)'), ...
       'Callback','KErv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','KErv');

    %Vurv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 148.3448275862069 24.20689655172414 12.41379310344828], ...
        'String','Vurv', ...
        'Style','text', ...
        'Tag','Vurv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',[433.8620689655173 148.9655172413793 37.24137931034483 12.41379310344828], ...
     'String',eval('num2str(Vurv)'), ...
       'Callback','Vurv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Vurv');

    %Emaxrv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 125.3793103448276 24.20689655172414 12.41379310344828], ...
        'String','Emrv', ...
        'Style','text', ...
        'Tag','Emaxrv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',mat28, ...
         'String',eval('num2str(initx(2))'), ...
       'Callback','initx(2)=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Emaxrv');

    %KRrv
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[399.7241379310346 103.0344827586207 24.20689655172414 12.41379310344828], ...
        'String','KRrv', ...
        'Style','text', ...
        'Tag','KRrv');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
       'Position',mat29, ...
       'String',eval('num2str(KRrv)'), ...
       'Callback','KRrv=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','KRrv');

    %Lsa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[74.48275862068967 71.3793103448276 24.20689655172414 12.41379310344828], ...
        'String','Lsa', ...
        'Style','text', ...
       'Tag','Lsa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',mat5, ...
        'String',eval('num2str(Lsa)'), ...
       'Callback','Lsa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
       'Tag','Lsa');

    %Lpa
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
        'ListboxTop',0, ...
        'Position',[74.48275862068967 49.0344827586207 24.20689655172414 12.41379310344828], ...
        'String','Lpa', ...
        'Style','text', ...
        'Tag','Lpa');
    h1 = uicontrol('Parent',h0, ...
        'Units','points', ...
        'BackgroundColor',[1 1 1], ...
        'ListboxTop',0, ...
        'Position',mat6, ...
        'String',eval('num2str(Lpa)'), ...
       'Callback','Lpa=str2num(get(gcbo, ''String''));',...
       'Style','edit', ...
        'Tag','Lpa');
    
end